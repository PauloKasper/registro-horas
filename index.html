<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <!-- PWA + iOS -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="theme-color" content="#007bff">
  <link rel="manifest" href="./assets/manifest.json">
  <link rel="apple-touch-icon" href="/icons/icon-192.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/icon-180.png">
  <link rel="apple-touch-startup-image" href="/splash.png">
  <link rel="stylesheet" href="style.css">
  <script src="cdn.jsdelivr.net"></script>
  <title>Registro de Horas</title>
</head>
<body>

<!-- LOGIN -->
<div id="tela-login" class="tela ativa">
  <h2>Acesso ao Sistema</h2>
  <input id="usuario" placeholder="Usuário (Nome)" autocomplete="username">
  <div class="input-wrap">
    <input id="senha" type="password" placeholder="Número do Colaborador" autocomplete="current-password">
    <button id="toggle-senha" class="eye-btn" aria-label="Mostrar senha">
      <svg id="icon-eye" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" fill="none">
      <path d="M1 12s4-7 11-7 11 7 11 7-4 7-11 7-11-7-11-7z"/>
      <circle cx="12" cy="12" r="3"/>
      </svg>
    </button>
  </div>
  <div id="erro-login" class="erro"></div>
  <button id="btn-entrar">Entrar</button>
  <button id="btn-abrir-cadastro">Não possui conta? Registrar-se</button>
</div>

<!-- CADASTRO -->
<div id="tela-cadastro" class="tela">
  <div class="cadastro-card">
    <h2>Cadastro Inicial</h2>
    <input id="cad-colaborador" placeholder="Colaborador">
    <input id="cad-numero" placeholder="Número do Colaborador">
    <div id="erro-cadastro" class="erro"></div>
    <div class="botoes-lado-a-lado">
      <button id="btn-salvar-cadastro">Salvar e Continuar</button>
      <button id="btn-voltar-login">Voltar</button>
    </div>
  </div>
</div>

<!-- PERFIL -->
<div id="tela-perfil" class="tela">
  <div class="sticky-wrapper">
    <div class="perfil-card">

      <div class="perfil-topo">
        <div class="foto-container">
          <img src="URL_DA_SUA_FOTO.jpg" alt="" class="profile-pic" id="profile-image-display">
          <input type="file" id="file-input" accept="image/png, image/jpeg" style="display: none;">
        </div>
      </div>

      <div class="menu-foto-container">
        <button id="btn-gerir-foto" class="btn-perfil-acao">Editar</button>
        <div id="popup-opcoes-foto" class="popup-opcoes">
          <button id="btn-adicionar-nova-foto" class="opcao-foto">Adicionar/Mudar Foto</button>
          <button id="btn-remover-foto" class="opcao-foto remover">Remover Foto</button>
        </div>
      </div>

      <div class="perfil-info-text">
        <h2 id="nome-usuario-perfil">Paulo Silva</h2>
        <p class="cargo" id="cargo-usuario-perfil">cargo</p>
      </div>

    </div>

   <div class="cards-container">
      <div class="card">
        <div class="flip">
          <div id="dias-front" class="face front">Total Dias</div>
          <div id="horas-back" class="face back">Total Horas</div>
        </div>
      </div>

      <div class="card">
        <div class="flip">
          <div id="refeicao-front" class="face front">Refeição Total</div>
          <div id="estimativa-back" class="face back">Estimativa</div>
        </div>
      </div>

      <!-- ✅ NOVO CARD -->
      <div class="card">
          <div class="flip">
            <div id="extras-front" class="face front">
              Extras (€)
            </div>
            <div id="extras-back" class="face back">
              <strong id="extras-total">€ 0.00</strong>
            </div>
          </div>
        </div>

    </div>


    <div id="card-horas-resumo" class="card-resumo">

  <h3>Resumo de Horas</h3>

  <!-- PARTE EXISTENTE (mantida) -->
  <div class="resumo-item">
    <span>Total de Horas:</span>
    <strong id="total-horas">0h</strong>
  </div>

  <div class="resumo-item">
    <span>Horas Extras (total):</span>
    <strong id="horas-extras">0h</strong>
  </div>

  <div class="resumo-item">
    <span>Horas Negativas:</span>
    <strong id="horas-negativas">0h</strong>
  </div>

  <hr>

  <!-- NOVA PARTE -->
  <h4 id="Extras-por-Escalão">Extras por Escalão</h4>

  <div class="resumo-item">
    <span>1ª hora extra:</span>
    <span id="extra-h1-horas">0.00h</span>
    <strong id="extra-h1-valor">€ 0.00</strong>
  </div>

  <div class="resumo-item">
    <span>2ª hora extra:</span>
    <span id="extra-h2-horas">0.00h</span>
    <strong id="extra-h2-valor">€ 0.00</strong>
  </div>

  <div class="resumo-item">
    <span>3ª+ horas:</span>
    <span id="extra-rest-horas">0.00h</span>
    <strong id="extra-rest-valor">€ 0.00</strong>
  </div>

  <hr>

  <div class="resumo-item resumo-total">
    <span>Total Extras (€):</span>
    <strong id="extra-total-valor">€ 0.00</strong>
  </div>

</div>


  </div>
</div>

<!-- REGISTRO (CALENDÁRIO) -->
<div id="tela-registro" class="tela">
    <!-- CABEÇALHO: MÊS + BOTÕES -->
  <div id="calendar-header">
    <button id="btn-mes-anterior">&lt;</button>
    <span id="month-year">Dezembro 2025</span>
    <button id="btn-proximo-mes">&gt;</button>
  </div>

  <!-- DIAS DA SEMANA -->
  <div id="weekdays">
    <div>Dom</div>
    <div>Seg</div>
    <div>Ter</div>
    <div>Qua</div>
    <div>Qui</div>
    <div>Sex</div>
    <div>Sab</div>
  </div>

  <div id="calendar"></div>
    <!-- Modal -->
  <div id="modal-horas" class="modal" aria-hidden="true">
      <div class="modal-content">
          <h2 id="modal-data"></h2>

        <label for="entrada">Entrada</label>
        <input id="entrada" type="text" inputmode="numeric" pattern="[0-9]*" maxlength="5" placeholder="hh:mm"
               oninput="this.value = formatarHora(this.value)">

        <label for="saidaAlmoco">Saída Almoço</label>
        <input id="saidaAlmoco" type="text" inputmode="numeric" pattern="[0-9]*" maxlength="5" placeholder="hh:mm"
               oninput="this.value = formatarHora(this.value)">

        <label for="retornoAlmoco">Retorno Almoço</label>
        <input id="retornoAlmoco" type="text" inputmode="numeric" pattern="[0-9]*" maxlength="5" placeholder="hh:mm"
               oninput="this.value = formatarHora(this.value)">

        <label for="saidaFinal">Saída Final</label>
        <input id="saidaFinal" type="text" inputmode="numeric" pattern="[0-9]*" maxlength="5" placeholder="hh:mm"
               oninput="this.value = formatarHora(this.value)">

          <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:8px;">
            <button id="salvar-horas">Salvar</button>
            <button id="fechar-modal" class="close-btn">Fechar</button>
          </div>
      </div>
  </div>

  <div class="botoes-lado-a-lado" style="margin-top:12px;">
    <button id="btn-gerar-csv">Imprimir</button>
  </div>

  <h2 id="usuario-logado" class="usuario-h2"></h2>
</div>

<!-- CONFIGURAÇÕES -->
<div id="tela-configurações" class="tela">
  <h2>Ajustes</h2>
  <div class="radio-inputs">
    <button id="btn-excluir-usuario" class="danger-button">Excluir Conta</button>

    <div id="modal-excluir-usuario" class="modal">
      <div class="modal-content">
        <h2>Excluir Conta</h2>
        <p>⚠ ATENÇÃO! Esta ação é permanente e não pode ser desfeita.</p>
        <p>Digite sua senha para confirmar:</p>
        <input type="password" id="senha-excluir" placeholder="Senha">
        <div id="erro-excluir" class="alerta"></div>
        <div class="modal-buttons">
          <button id="cancelar-exclusao">Cancelar</button>
          <button id="confirmar-exclusao" disabled>Excluir Conta</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- BOTTOM NAV -->
<div id="bottom-nav" class="radio-inputs oculto">
  <label class="radio">
    <input type="radio" name="bottom-nav" checked>
    <span class="name">Perfil</span>
  </label>
  <label class="radio">
    <input type="radio" name="bottom-nav">
    <span class="name">Registrar Horas</span>
  </label>
  <label class="radio">
    <input type="radio" name="bottom-nav">
    <span class="name">Ajustes</span>
  </label>
  <label class="radio">
    <input type="radio" name="bottom-nav">
    <span class="name">Sair</span>
  </label>
</div>

<!-- POPUP -->
<div id="popup-ciclo" style="display:none;">
  <div class="popup-conteudo">
    <div id="popup-text"></div>
    <button id="popup-fechar">OK</button>
  </div>
</div>

<!-- INÍCIO DO BLOCO OCULTO DO PDF (NÃO APARECE NA TELA) -->
<div id="pdf-container" >

    <div id="pdf-content" class="page">

            <div class="header">FOLHA DE HORAS</div>
                   <div class="header-top">
                        <img id="logo-empresa" src="assets/adecco.png" alt="Adecco">
                   </div>

            <div class="info-grid">
              <div class="info-grid">
                <div class="info-label">COLABORADOR:</div>
                <div class="info-value" id="colaborador"></div>

                <div class="info-label">DATA:</div>
                <div class="info-value" id="data_emissao"></div>

                <div class="info-label">FUNÇÃO:</div>
                <div class="info-value" id="funcao"></div>

                <div class="info-label">EMPRESA:</div>
                <div class="info-value" id="empresa"></div>

                <div class="info-label">CONTRIBUINTE:</div>
                <div class="info-value" id="contribuinte"></div>

                <div class="info-label">HORÁRIO:</div>
                <div class="info-value" id="horario"></div>
            </div>

                <div><!-- Outras informações aqui --></div>

            </div>

            <!-- NOVO CONTAINER para a tabela e a caixa flutuante -->
    <div class="table-container">
    <table>
        <!-- ... SEU THEAD EXISTENTE AQUI ... -->
        <thead>
            <tr>
                <th rowspan="2">DIA</th>
                <th rowspan="2">ENTRADA</th><th rowspan="2">SAÍDA</th><th rowspan="2">ENTRADA</th><th rowspan="2">SAÍDA</th>
                <th rowspan="2">TOTAL DE HORAS<br> TRABALHADAS</th>
                <th rowspan="2">Nº HORAS<br> NOTURNAS</th>
                <th colspan="5">HORAS EXTRAS</th>
                <th colspan="1">FORMAÇÃO</th>
                <th colspan="1">SUBSTITUIÇÃO</th>
                <th colspan="1">FÉRIAS</th>
                <th colspan="2">FALTAS JUST.</th>
                <th rowspan="2">FALTAS INJUST.</th>
            </tr>
           <tr>
                <th>1</th>
                <th>2</th>
                <th>REST</th>
                <th>SAB/DOM</th>
                <th>FERIADOS</th>
                <th>N</th>
                <th>N</th>
                <th>P</th>
                <th>P</th>
                <th>NP</th>
            </tr>

        </thead>
        <tbody id="tabela-body">
            <!-- Linhas geradas via JS (devem ter 19 colunas TD vazias/preenchidas) -->
        </tbody>
        <tfoot id="table-footer-totals">
            <!-- ... Linha Vazia (empty-total-row) permanece igual ... -->
            <tr class="empty-total-row">
                <td colspan="18">&nbsp;</td>
            </tr>

            <tr class="total-row">
                <td colspan="4"></td>
                <td style="font-weight:bold;">TOTAL</td>

                <td id="total-horas-trabalhadas"></td>
                <td id="total-horas-noturnas"></td>

                <td id="total-extra-1"></td>
                <td id="total-extra-2"></td>
                <td id="total-extra-rest"></td>
                <td id="total-sabdom"></td>
                <td id="total-feriados"></td>

                <td></td> <!-- Formação -->
                <td></td> <!-- Substituição -->
                <td></td> <!-- Férias -->
                <td></td> <!-- Férias -->
                <td></td> <!-- Faltas Just -->
                <td></td> <!-- Faltas Injust -->
            </tr>


        </tfoot>

    </table>

    <!-- BLOCO DE CÁLCULO ÚNICO DE SUBSÍDIOS (FLEXBOX solution) -->
    <div class="floating-calc-box" >
        <div class="calc-header">SUBSÍDIOS</div>

        <!-- Conteúdo com divisões internas para imitar as linhas da tabela -->
        <div class="calc-body-content">
            <!-- Refeição/Cálculo (Ocupa várias linhas visuais) -->
            <div style="border-bottom: 0.01px solid #333; height: 63px; padding: 5px 2px; text-align: left; vertical-align: top;">
                <strong>Refeição<br></strong><br>
                <div id="subsidio-refeicao" style="font-size:14px;font-weight:bold;"></div>
            </div>

            <div style="border-bottom: 0.01px solid #333; height: 35px; padding: 5px 2px; text-align: left;">
                Outros
            </div>

            <!-- TRABALHADOR ADECCO -->
            <div style="border-bottom: 0.01px solid #333; height: 2px; padding: 5px 2px; text-align: left;">
                TRABALHADOR ADECCO
            </div>

            <!-- Assinatura -->
            <div style="border-bottom: 0.01px solid #333; height: 60px; padding: 3.5px 2px; text-align: left;">
                <br><br><br><br><br><br><br><br>Assinatura<br><br>
                Data: <span id="data-assinatura"></span>
            </div>

            <!-- Divs vazias para preencher o espaço -->
            <div style="border-bottom: 0.01px solid #333; height: 12px ;"></div>
            <div style="border-bottom: 0.01px solid #333; height: 62px;"></div>

            <!-- Confirmação do Serviço Prestado -->
            <div style="border-bottom: 0.01px solid #333; height: 15px; padding: 4.4px 2px; text-align: left;">
                 Confirmação <br> do Serviço Prestado
             </div>

            <div style="border-bottom: 0.01px solid #333; height: 24.7px ;"></div>
            <div style=" height: 20.5px; padding: 5px 2px; text-align: left;">
                Nome do Resp. do Departamento
            </div>
        </div>
    </div>
</div>
        <div class="footer-container">
            <div class="footer-column">
                <p>Sede: R. Antonio Pedro nº111-3° Frente-1150-045 Lisboa</p>
                <p>Segurança Social N° 564999 Fax: 213519629</p>
            </div>
            <div class="footer-column">
                <p>Contribuinte N° 503 402 516</p>
                <p>Sociedade por Quotas</p>
            </div>
            <div class="footer-column">
                <p>Registada na C.R.C. de Lisboa sob o nº5190-Capital Social 25.000 €</p>
            </div>
        </div>


<!-- Secção de Assinaturas (Redundante agora, mas mantida como no seu código) -->
<div class="signature-grid">
    <!-- ... seu HTML de assinaturas aqui ... -->
</div>
</div> <!-- pdf-content -->

</div> <!-- pdf-container -->


<!-- Inclua as bibliotecas necessárias COM OS LINKS COMPLETOS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<script src="script.js"></script>
</body>
</html>


